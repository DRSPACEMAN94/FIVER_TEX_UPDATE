 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page Title</title>
    <style>
        body {
            margin: 0;
            border: 0;
            padding: 0;
            overflow: hidden;
        }
        .webgl {
            outline: none;
            position: fixed;
            top: 0;
            left: 0;
        }
    </style>

    <script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.138.3/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.138.3/examples/jsm/"
            }
        }
    </script>
    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        import { RGBELoader } from 'three/addons/loaders/RGBELoader.js';
        import "https://code.jquery.com/jquery-2.2.4.min.js";

        const SOCKETURL = "http://localhost:3000/github-webhook";

        const canvas = document.querySelector('canvas.webgl');
        const scene = new THREE.Scene();

        let shirtobj = false;
        let storedtexture = false;

        new RGBELoader()
            .setPath('./models/')
            .load('bg.hdr', function (texture) {

                texture.mapping = THREE.EquirectangularReflectionMapping;
                scene.environment = texture;
                const loader = new GLTFLoader().setPath('./models/');
                loader.load('shirt.gltf', async function (gltf) {

                    gltf.scene.traverse(function (child) {
                        if (child.userData.name == "Shirt") {
                            shirtobj = child;
                        }
                    });
                    const model = gltf.scene;
                    model.rotation.y -= 0;
                    model.position.y = -4;
                    scene.add(model);
                    refreshload();
                });

            });

        const sizes = {
            width: window.innerWidth,
            height: window.innerHeight
        }

        window.addEventListener('resize', resizecallback);
        function resizecallback() {
            sizes.width = window.innerWidth;
            sizes.height = window.innerHeight;

            camera.aspect = sizes.width / sizes.height;
            camera.updateProjectionMatrix();
            renderer.setSize(sizes.width, sizes.height);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        }

        const aspectRatio = sizes.width / sizes.height;

        const camera = new THREE.PerspectiveCamera(70, sizes.width / sizes.height, 1, 1000);
        camera.position.z = 13;
        camera.position.y = 0;
        scene.add(camera);

        const cursor = { x: 0, y: 0 }

        canvas.addEventListener('mousemove', movecallback, false);
        function movecallback(event) {
            cursor.x = (event.clientX / sizes.width) * 2 - 1;
            cursor.y = - (event.clientY / sizes.height) * 2 + 1;
        }

        const controls = new OrbitControls(camera, canvas);
        controls.enableDamping = true;

        const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true, antialias: true, powerPreference: 'high-performance' });
        renderer.setSize(sizes.width, sizes.height);
        renderer.setClearColor(0xffffff, 0);

        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.setPhysicalyCorrectLights = true;

        renderer.outputEncoding = THREE.sRGBEncoding;

        renderer.toneMapping = THREE.ACESFilmicToneMapping;

        function animate() {
            controls.update();
            renderer.render(scene, camera);
            window.requestAnimationFrame(animate);

        }
        animate();

        setInterval(refreshload, 10000);

        function refreshload() {

            $.ajax({
                url: SOCKETURL, type: 'post', success: function (result) {
                    if (storedtexture != result) {
                        if (shirtobj) {
                            var textureLoader = new THREE.TextureLoader();
                            var texture = textureLoader.load(result);
                            var material = shirtobj.material.clone();
                            material.map = texture;
                            shirtobj.material = material;
                            material.side = THREE.DoubleSide;
                            storedtexture = result;
                        }
                    }
                }
            });

        }

    </script>
</head>

<body>
    <div class="canvasparent" id="canvasparent">
        <canvas class="webgl"></canvas>
    </div>
</body>

</html>